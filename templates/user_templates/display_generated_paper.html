{% extends 'user_templates/base.html' %}

{% block title %}Generated Question Paper - {{ paper.title }}{% endblock %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

<style>
    @media print {
        body > nav,
        body > footer,
        .no-print {
            display: none !important;
        }
        .container {
            max-width: 100%;
        }
        .card {
            border: 1px solid #dee2e6 !important;
            box-shadow: none !important;
        }
    }

    .section-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #495057;
        margin-bottom: 0.75rem;
    }

    .label-text {
        font-weight: 500;
        color: #6c757d;
    }

    .info-value {
        font-size: 1.1rem;
        font-weight: 500;
        color: #212529;
    }

    .group-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #343a40;
    }

    .list-group-item {
        font-size: 1.05rem;
        line-height: 1.6;
    }
</style>
{% endblock head %}


{% block content %}
<div class="container my-5">

    <!-- Paper Header Card -->
    <div class="card shadow-lg mb-5">
        <div class="card-header bg-dark text-white p-4 no-print">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div>
                    <h2 class="mb-1">{{ paper.title }}</h2>
                    <small class="text-white-50">{{ paper.subject.name }}</small>
                </div>
                <div class="mt-2 mt-md-0">
                    <a href="{{ url_for('download_question_paper', paper_id=paper.id) }}" class="btn btn-outline-light me-2">
                        <i class="bi bi-download me-2"></i>Download PDF
                    </a>
                    <button onclick="window.print()" class="btn btn-outline-light">
                        <i class="bi bi-printer me-2"></i>Print
                    </button>
                </div>
            </div>
        </div>
        <div class="card-body p-4">
            <div class="row g-4">
                <div class="col-md-8">
                    <div class="section-title">{{ paper.title }}</div>
                    <div class="mt-2">
                        <span class="label-text"><i class="bi bi-book me-2"></i>Subject:</span>
                        <span class="info-value">{{ paper.subject.name }}</span>
                    </div>
                    <div class="mt-2">
                        <span class="label-text"><i class="bi bi-bar-chart-line me-2"></i>Difficulty:</span>
                        <span class="badge bg-secondary">{{ paper.difficulty.capitalize() }}</span>
                    </div>
                    {% if semester %}
                    <div class="mt-2">
                        <span class="label-text"><i class="bi bi-journal me-2"></i>Semester:</span>
                        <span class="info-value">{{ semester }}</span>
                    </div>
                    {% endif %}
                    {% if exam_year %}
                    <div class="mt-2">
                        <span class="label-text"><i class="bi bi-calendar me-2"></i>Exam Year:</span>
                        <span class="info-value">{{ exam_year }}</span>
                    </div>
                    {% endif %}
                    {% if time_allotted %}
                    <div class="mt-2">
                        <span class="label-text"><i class="bi bi-clock me-2"></i>Time Allotted:</span>
                        <span class="info-value">
                            {% set hours = time_allotted // 60 %}
                            {% set minutes = time_allotted % 60 %}
                            {{ hours }} hour{{ 's' if hours != 1 else '' }}{% if minutes > 0 %} {{ minutes }} minute{{ 's' if minutes != 1 else '' }}{% endif %}
                        </span>
                    </div>
                    {% endif %}
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="mt-2">
                        <span class="label-text"><i class="bi bi-calendar-event me-2"></i>Generated on:</span>
                        <span class="info-value">{{ paper.generation_date.strftime('%d %b %Y, %I:%M %p') }}</span>
                    </div>
                    <div class="mt-3">
                        <h5 class="text-primary fw-semibold">Total Marks: {{ total_marks }}</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Group A -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-light">
            <h5 class="group-title mb-0">Group A – Short Answer Questions (2 Marks each)</h5>
        </div>
        <div class="card-body">
            {% if group_a %}
                <ol class="list-group list-group-numbered list-group-flush">
                    {% for q in group_a %}
                        <li class="list-group-item p-3">{{ q.text }}</li>
                    {% endfor %}
                </ol>
            {% else %}
                <p class="text-muted p-3">No questions are available for Group A.</p>
            {% endif %}
        </div>
    </div>

    <!-- Group B -->
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-light">
            <h5 class="group-title mb-0">Group B – Long Answer Questions (8 Marks each)</h5>
        </div>
        <div class="card-body">
            {% if group_b %}
                <ol class="list-group list-group-numbered list-group-flush">
                    {% for q in group_b %}
                        <li class="list-group-item p-3">{{ q.text }}</li>
                    {% endfor %}
                </ol>
            {% else %}
                <p class="text-muted p-3">No questions are available for Group B.</p>
            {% endif %}
        </div>
    </div>

    <!-- Back Button -->
    <div class="text-center mt-5 no-print">
        <a href="{{ url_for('user_dashboard') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left-short"></i> Back to Dashboard
        </a>
    </div>

</div>
{% endblock %}
